# Workflows

## Normalization

```

                             ┌─────────┐
                             │ _START_ │
                             └────┬────┘
                                  │
                                  ▼
                     ┌─────────────────────────┐
                     │   embed_train_events    │
                     │        EMBED LLM        │
                     └───────────┬─────────────┘
                                 │
                                 ▼
                     ┌─────────────────────────┐
                     │    embed_pred_events    │
                     │        EMBED LLM        │
                     └───────────┬─────────────┘
                                 │
                                 ▼
                     ┌─────────────────────────┐                           cleanup_subgraph
                     │  prepare_pred_prompts   │      ┌─  ──  ──   ──   ──   ──   ──  ──  ┐
                     │        FUNCTION         │
                     └───────────┬─────────────┘      │  ┌─────────────────────────────┐  │
                                 │                       │    remove_markdown_quotes   │
                                 ▼                    │  │         TOOL FUNCTION       │  │
                     ┌─────────────────────────┐         └──────────────●──────────────┘
                     │  normalize_pred_events  │      │                 │                 │
                     │           LLM           │                        │
                     └───────────┬─────────────┘      │  ┌─────────────────────────────┐  │
                                 │      ┌────────────────│     cleanup_norm_fields     │
                                 │      │             │  │             LLM             │  │
                                 │      │                └─────────────────────────────┘
                                 │      │             │                 ▲                 │
                                 ▼      ▼                               │
                   ┌─────────────────────────┐        │                 │                 │
                   │    scan_norm_fields     │           ┌─────────────────────────────┐
                   │        FUNCTION         │        │  │ cleanup_invalid_norm_fields │  │
                   └───────┬─────────┬───────┘           │          FUNCTION           │
                           │         │                │  └─────────────────────────────┘  │
                        no │  broken │ yes                       ▲
                           │  JSON?  │                └  ──   ── │ ──   ──   ──   ──  ──  ┘
                           ▼         │                           │
                      ┌────────┐     │       ┌─────────────────────────┐
                      │ _END_  │     └───── ►│   prepare_cleanup_jobs  │
                      └────────┘             │         FUNCTION        │
                                             └─────────────────────────┘

```
